{% extends "base.html" %}

{% block title %}Order History{% endblock %}

{% block content %}
<div class="container" style="max-width: 800px; margin: 2rem auto;">
    <h1>Order History</h1>

    <!-- Styles for status badges -->
    <style>
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .status-delivered {
            background: #d4edda;
            color: #155724;
        }

        .status-shipped {
            background: #cce5ff;
            color: #004085;
        }

        .status-created {
            background: #fff3cd;
            color: #856404;
        }

        .status-out {
            background: #ffeeba;
            color: #856404;
        }
    </style>

    {% if orders %}
    <!-- Table listing all user's previous orders -->
    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
        <thead>
            <tr style="border-bottom: 2px solid #ddd; text-align: left;">
                <th style="padding: 10px;">Order ID</th>
                <th style="padding: 10px;">Date</th>
                <th style="padding: 10px;">Total</th>
                <th style="padding: 10px;">Status</th>
                <th style="padding: 10px;">Items</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 10px;">
                    <a href="{% url 'orders:order_detail' order.order_id %}"
                        style="font-weight: bold; color: #007bff; text-decoration: none;">
                        #{{ order.order_id }}
                    </a>
                </td>
                <td style="padding: 10px;">{{ order.created_at|date:"M d, Y" }}</td>
                <td style="padding: 10px;">${{ order.get_total_cost }}</td>
                <td style="padding: 10px;">
                    <!-- Badge changes color based on status -->
                    <span
                        class="status-badge {% if order.status == 'Delivered' %}status-delivered{% elif order.status == 'Shipped' %}status-shipped{% elif order.status == 'Out for Delivery' %}status-out{% else %}status-created{% endif %}">
                        {{ order.status }}
                    </span>
                </td>
                <td style="padding: 10px;">
                    {% for item in order.items.all %}
                    {{ item.quantity }}x {{ item.product.name }}<br>
                    {% endfor %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p>You haven't placed any orders yet.</p>
    {% endif %}

    <div style="margin-top: 20px;">
        <a href="{% url 'account' %}" style="text-decoration: none; color: #007bff;">&larr; Back to Dashboard</a>
    </div>
</div>
{% endblock %}